{
  "_comment": "Precondition rules for ACE Pelican error codes - COMPLETE VERSION",
  "_logic": "require_true: ALL must be True. require_false: at least ONE must be False (validation failed)",
  "_version": "2.1 - Updated with complete error code list",

  "_section_8xxx": "8XXX VALIDATION ERRORS",

  "8001": {
    "require_true": ["has_bic"],
    "require_false": ["bic_valid_format", "bic_valid_country"],
    "description": "Invalid BIC - BIC present but format or country code invalid"
  },

  "8003": {
    "require_true": [],
    "require_false": [],
    "description": "File name derivation failed - system/config issue, not predictable from message",
    "_note": "Unpredictable - depends on system configuration"
  },

  "8004": {
    "require_true": ["needs_iban"],
    "require_false": ["has_iban"],
    "description": "IBAN cannot be derived - IBAN required but missing and cannot be derived from available data",
    "_note": "Only applies to party accounts (BNPPTY, CDTPTY, etc), not banks. needs_iban only set if no account info exists."
  },

  "8005": {
    "require_true": ["has_bic"],
    "require_false": ["bic4_valid"],
    "description": "Invalid BIC4 - first 4 characters of BIC are invalid (must be letters A-Z)"
  },

  "8006": {
    "require_true": ["has_country"],
    "require_false": ["country_valid"],
    "description": "Invalid country code - country code is not a valid ISO 3166-1 alpha-2 code"
  },

  "8007": {
    "require_true": ["has_amount"],
    "require_false": ["amount_decimals_valid"],
    "description": "Number of fractional digits of amount exceeds maximum allowable",
    "global_feature": true
  },

  "8022": {
    "require_true": ["has_iban", "has_bic"],
    "require_false": ["bic_iban_match"],
    "description": "IBAN inconsistent with Account With Institution BIC - countries do not match"
  },

  "8023": {
    "require_true": ["has_iban", "has_multiple_ibans"],
    "require_false": ["ibans_consistent"],
    "description": "IBAN inconsistency found in message - multiple different IBANs across parties",
    "global_feature": true,
    "_note": "Only fires when multiple IBANs exist AND they're different"
  },

  "8024": {
    "require_true": ["has_bban"],
    "require_false": ["bbans_consistent"],
    "description": "BBAN inconsistency found in message - multiple different BBANs across parties",
    "global_feature": true,
    "_note": "Rare - most messages don't have explicit BBANs"
  },

  "8025": {
    "require_true": [],
    "require_false": [],
    "description": "Domestic Account Number inconsistency found in message",
    "global_feature": true,
    "_note": "Disabled - different parties legitimately have different accounts"
  },

  "8026": {
    "require_true": ["has_nch", "has_multiple_nchs"],
    "require_false": ["nchs_consistent"],
    "description": "NCH inconsistency found in message - multiple different NCH/routing codes",
    "global_feature": true,
    "_note": "Only fires when multiple NCHs exist AND they're different"
  },

  "8027": {
    "require_true": ["has_country", "has_multiple_countries"],
    "require_false": ["countries_consistent"],
    "description": "ISO Country Code inconsistency found in message - conflicting country codes",
    "global_feature": true,
    "_note": "Cross-border payments legitimately have multiple countries - be careful"
  },

  "8028": {
    "require_true": ["has_bic", "has_multiple_bic4s"],
    "require_false": ["bic4s_consistent"],
    "description": "BIC4 inconsistency found in message - first 4 chars of BICs inconsistent",
    "global_feature": true,
    "_note": "Only fires when multiple BICs exist AND BIC4s differ"
  },

  "8029": {
    "require_true": [],
    "require_false": [],
    "description": "Account Number inconsistency found in message",
    "global_feature": true,
    "_note": "Disabled - different parties legitimately have different accounts"
  },

  "8030": {
    "require_true": ["needs_iban"],
    "require_false": ["iban_derivation_supported"],
    "description": "IBAN derivation not supported for the country",
    "_note": "Only applies to party accounts, not banks"
  },

  "8033": {
    "require_true": ["has_clabe"],
    "require_false": ["clabes_consistent"],
    "description": "CLABE inconsistency found in message - Mexican CLABE numbers inconsistent",
    "global_feature": true
  },

  "8034": {
    "require_true": [],
    "require_false": [],
    "description": "Forced Debit is not allowed and hence message cannot be processed",
    "_note": "Business rule - not predictable from message content alone"
  },

  "8035": {
    "require_true": [],
    "require_false": [],
    "description": "FCDA account validation failed",
    "_note": "Requires directory lookup - not predictable"
  },

  "8036": {
    "require_true": [],
    "require_false": [],
    "description": "FCDA account name matching failed",
    "_note": "Requires directory lookup - not predictable"
  },

  "8124": {
    "require_true": ["has_currency"],
    "require_false": ["currency_valid"],
    "description": "Invalid currency - currency code is not a valid ISO 4217 code",
    "global_feature": true
  },

  "8464": {
    "require_true": [],
    "require_false": [],
    "description": "Target Channel not derived",
    "_note": "Requires routing/config lookup - not predictable"
  },

  "8465": {
    "require_true": [],
    "require_false": [],
    "description": "Product code not found",
    "_note": "Requires product directory lookup - not predictable"
  },

  "8472": {
    "require_true": [],
    "require_false": [],
    "description": "Fee code not derived",
    "_note": "Requires fee directory lookup - not predictable"
  },

  "8851": {
    "require_true": [],
    "require_false": [],
    "description": "Incorrect field size - XML schema validation error",
    "_note": "Schema-level error - unpredictable from parsed features"
  },

  "8852": {
    "require_true": [],
    "require_false": [],
    "description": "Incorrect length of attribute - XML attribute length validation error",
    "_note": "Schema-level error - unpredictable from parsed features"
  },

  "8853": {
    "require_true": [],
    "require_false": [],
    "description": "Incorrect number format",
    "_note": "Schema-level error - unpredictable from parsed features"
  },

  "8892": {
    "require_true": ["has_account"],
    "require_false": ["account_valid"],
    "description": "Invalid Account number - account number fails format validation"
  },

  "8894": {
    "require_true": ["has_iban"],
    "require_false": ["iban_valid_format", "iban_checksum_valid"],
    "description": "Invalid IBAN - format invalid or checksum failed"
  },

  "8895": {
    "require_true": ["has_nch", "nch_validation_applicable"],
    "require_false": ["nch_valid", "fedaba_checksum_valid"],
    "description": "Invalid NCH code - routing number format invalid or checksum failed"
  },

  "8896": {
    "require_true": ["has_account", "is_domestic"],
    "require_false": ["account_valid"],
    "description": "Invalid Domestic Account Number"
  },

  "8897": {
    "require_true": ["has_bban"],
    "require_false": ["bban_valid"],
    "description": "Invalid BBAN - Basic Bank Account Number format is invalid"
  },

  "8898": {
    "require_true": ["has_iban"],
    "require_false": ["iban_checksum_valid"],
    "description": "IBAN Check Digit calculation/validation failed"
  },

  "8905": {
    "require_true": [],
    "require_false": [],
    "description": "Hash code Mismatch",
    "_note": "Security/integrity check - not predictable"
  },

  "8906": {
    "require_true": [],
    "require_false": [],
    "description": "Message in wrong flow",
    "_note": "Workflow/routing issue - not predictable from message content"
  },

  "_section_9xxx": "9XXX REPAIR/ENRICHMENT CODES",

  "9000": {
    "require_true": ["present", "has_nch", "nch_has_dirty_chars"],
    "require_false": [],
    "description": "NCH cleaned - routing number had special characters removed"
  },

  "9002": {
    "require_true": ["present", "has_account", "account_has_dirty_chars"],
    "require_false": [],
    "description": "Account cleaned - account number had special characters removed"
  },

  "9004": {
    "require_true": ["present", "needs_iban"],
    "require_false": ["has_iban"],
    "description": "IBAN derived for credit party - IBAN computed from account and BIC/NCH"
  },

  "9005": {
    "require_true": ["present", "has_nch"],
    "require_false": ["has_bic"],
    "description": "BIC derived from NCH - BIC looked up from routing number directory"
  },

  "9006": {
    "require_true": ["present", "has_iban", "iban_needs_formatting"],
    "require_false": [],
    "description": "IBAN formatted - IBAN normalized (spaces removed, uppercase)"
  },

  "9007": {
    "require_true": ["present", "needs_iban"],
    "require_false": ["has_iban"],
    "description": "IBAN derived for beneficiary - IBAN computed from account and BIC/NCH"
  },

  "9008": {
    "require_true": ["present", "has_iban"],
    "require_false": ["has_bic"],
    "description": "BIC derived from IBAN - BIC extracted or looked up from IBAN"
  },

  "9015": {
    "require_true": ["present", "has_name", "name_has_dirty_chars"],
    "require_false": [],
    "description": "Name cleaned - party name had special characters removed or normalized"
  },

  "9017": {
    "require_true": ["present", "has_multiple_ids"],
    "require_false": [],
    "description": "Multiple IDs consolidated - duplicate or redundant identifiers merged"
  },

  "9018": {
    "require_true": ["intm_has_multiple", "intm_has_redundant_info"],
    "require_false": [],
    "description": "Duplicate party removed - redundant intermediary entry removed",
    "global_feature": true
  },

  "9019": {
    "require_true": ["present", "any_id_needs_cleaning"],
    "require_false": [],
    "description": "Party identifier cleaned - ID/IBAN had non-alphanumeric characters removed"
  },

  "9021": {
    "require_true": ["present", "has_nch", "nch_needs_formatting"],
    "require_false": [],
    "description": "NCH formatted - routing number normalized to standard format"
  },

  "9024": {
    "require_true": ["has_intermediary"],
    "require_false": [],
    "description": "Push Up performed - intermediary consolidated or moved in party hierarchy",
    "global_feature": true
  },

  "9025": {
    "require_true": ["present", "has_account", "account_needs_length_fix"],
    "require_false": [],
    "description": "Account length fixed - account number padded or truncated to correct length"
  },

  "9477": {
    "require_true": ["present", "has_bic", "bic_length_8"],
    "require_false": [],
    "description": "BIC enriched 8->11 chars - 8-character BIC expanded to 11-character format"
  },

  "9479": {
    "require_true": ["present", "has_bic"],
    "require_false": [],
    "description": "Party enriched from BIC - party details populated from BIC directory lookup"
  },

  "9480": {
    "require_true": ["present", "has_bic"],
    "require_false": [],
    "description": "Credit party enriched - credit party details enhanced from directory"
  },

  "_section_suppress": "CODES TO SUPPRESS (unpredictable or directory-dependent)",

  "_suppressed_codes": {
    "8003": "File name derivation - system config",
    "8034": "Forced Debit business rule",
    "8035": "FCDA validation - directory",
    "8036": "FCDA name matching - directory",
    "8464": "Target Channel - routing config",
    "8465": "Product code - product directory",
    "8472": "Fee code - fee directory",
    "8851": "Field size - schema validation",
    "8852": "Attribute length - schema validation",
    "8853": "Number format - schema validation",
    "8905": "Hash mismatch - security check",
    "8906": "Wrong flow - workflow routing",
    "9490": "Fee Code Updated - fee directory",
    "9999": "Field Repair - generic catch-all"
  }
}
